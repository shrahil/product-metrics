{
  "gitSyncId": "664c50c6369d527a59213df2_07d97d8f-61b9-4996-8c0f-e13519c252cb",
  "id": "Retention Metrics_TenQs",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "/*\nQuery to get the number of unique users who have practiced more than 10 questions \nand were created within the specified time period.\nWe are checking the sum of \"eventCount\" where \"event\" = 'Questions' in the \"DailyUserEvent\" table.\n*/\n\n/*\nSubquery to calculate the total questions practiced by each user\nwithin the specified time period.\n*/\nWITH created_users AS (\n    SELECT \n        \"id\"\n    FROM \n        \"User\"\n    WHERE \n        \"createdAt\" >= {{moment(DatePicker1.selectedDate).format(\"YYYY-MM-DD\")}}::date - interval '330 minutes'\n        AND \"createdAt\" <= {{moment(DatePicker2.selectedDate).format(\"YYYY-MM-DD\")}}::date + interval '1110 minutes'\n),\nuser_question_counts AS (\n    SELECT \n        \"userId\",\n        SUM(\"eventCount\") AS total_questions_practiced\n    FROM \n        \"DailyUserEvent\"\n    WHERE \n        \"event\" = 'Question'\n        AND \"eventDate\" BETWEEN '2024-01-01' AND '2024-12-31' -- Specify the desired time period here\n    GROUP BY \n        \"userId\"\n)\n\n/*\nSubquery to select users created within the specified time period.\n*/\n\n\n/*\nMain query to count the number of unique users who have practiced more than 10 questions\nand were created within the specified time period.\n*/\nSELECT \n    COUNT(DISTINCT uqc.\"userId\") AS unique_users\nFROM \n    user_question_counts uqc\nJOIN \n    created_users cu ON uqc.\"userId\" = cu.\"id\"\nWHERE \n    uqc.total_questions_practiced > 20;\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 100000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "learner1",
      "isAutoGenerated": false,
      "name": "learner1",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "executeOnLoad": true,
    "name": "TenQs",
    "pageId": "Retention Metrics",
    "userSetOnLoad": false
  }
}